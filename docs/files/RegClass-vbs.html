<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>RegClass.vbs</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.1 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="CWMIReg"></a><a name="Topic1"></a><div class="CTopic TClass LVisualBasic first">
 <div class="CTitle">CWMIReg</div>
 <div id="NDPrototype1" class="NDPrototype NoParameterForm">Class CWMIReg</div>
 <div class="CBody"><p>WMI-derived Registry class for VBScript.</p><p>All variables in this class have &quot;_&quot; appended.&nbsp; Unfortunately, that makes the code a bit more difficult to read. It was done in order to avoid possible conflicts with variable names in code in scripts that use the class.</p><div class="CHeading">Version</div><p>3.0.2</p><div class="CHeading">Author</div><ul><li><p>Joe Priestley (2004-2008)</p></li><li><p>Eduardo Mozart de Oliveira (2014-2017)</p></li></ul><div class="CHeading">Data Type</div><table class="CDefinitionList"><tr><td class="CDLEntry">REG_SZ</td><td class="CDLDefinition"><p>A string value.</p></td></tr><tr><td class="CDLEntry">REG_EXPAND_SZ</td><td class="CDLDefinition"><p>An expanded string data value. The environment variable specified in the string must exist for the string to be expanded when you call GetValue.</p></td></tr><tr><td class="CDLEntry">REG_BINARY</td><td class="CDLDefinition"><p>An array of binary data values. The script can set REG_BINARY keys as long as they are in the format used by a regedit.exe export or a bytes Array. See <b>examples\Create Demo.vbs</b>.</p></td></tr><tr><td class="CDLEntry">REG_DWORD</td><td class="CDLDefinition"><p>A numeric data value.</p></td></tr><tr><td class="CDLEntry">REG_MULTI_SZ</td><td class="CDLDefinition"><p>A list of strings. The SetValue method accepts an array of strings as the parameter that determines the values of the entry. Note that if you use the SetValue method to append to an existing multistring-valued entry rather than create a new one, you have to first use the GetValue method to retrieve the existing list of strings. This is because SetValue overwrites any existing value.</p></td></tr><tr><td class="CDLEntry">REG_QWORD</td><td class="CDLDefinition"><p>A QWORD data value for the named value.</p></td></tr></table><div class="CHeading">Error Codes</div><p>Most of the functions return error codes. There are standard error codes (negative numbers) that mean the same for all functions.</p><table class="CDefinitionList"><tr><td class="CDLEntry">-1</td><td class="CDLDefinition"><p>Invalid Path</p></td></tr><tr><td class="CDLEntry">-2</td><td class="CDLDefinition"><p>Invalid HKey</p></td></tr><tr><td class="CDLEntry">-3</td><td class="CDLDefinition"><p>Invalid Key Path</p></td></tr><tr><td class="CDLEntry">-4</td><td class="CDLDefinition"><p>Permission denied</p></td></tr><tr><td class="CDLEntry">-5</td><td class="CDLDefinition"><p>OS arch mismatch (Example: Assigning a QWord into a 32-bit OS)</p></td></tr><tr><td class="CDLEntry">&lt; 0</td><td class="CDLDefinition"><p>Other error codes specific to the functions. See <a href="https://msdn.microsoft.com/en-us/library/aa393978(v=vs.85).aspx" target="_top">https://&#8203;msdn&#8203;.microsoft&#8203;.com&#8203;/en-us&#8203;/library&#8203;/aa393978(v=vs&#8203;.85)&#8203;.aspx</a> (WbemErrorEnum)</p></td></tr></table><div class="CHeading">See Also</div><p><a href="http://msdn.microsoft.com/en-us/library/aa393664.aspx" target="_top">WMI Reference, StdRegProv Class</a> <a href="http://www.serverwatch.com/tutorials/article.php/1476861" target="_top">Managing Windows Registry with Scripting (Part 2)</a></p></div>
</div>

<a name="CWMIReg.Functions"></a><a name="Topic2"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Functions</div>
</div>

<a name="CWMIReg.Exists"></a><a name="Topic3"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Exists</div>
 <div id="NDPrototype3" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function Exists(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>The class's Exists function uses key or value enumeration to check whether a key or value exists, and also returns the data type for existing values.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>Add &quot;\&quot; at end for keys.</p></td></tr></table><div class="CHeading">Returns</div><p>Returns data type if value, &quot;K&quot; if key, or &quot;&quot; if not found. (Note that WMI seems to often, perhaps always, return &quot;REG_EXPAND_SZ&quot; for plain string values, but it generally doesn't matter. A value that WMI says is &quot;REG_EXPAND_SZ&quot; can still be read or written as &quot;REG_SZ&quot;, and when calling GetValue the Type parameter can be sent as &quot;&quot;, leaving the GetValue function to handle the ambiguity.)</p></div>
</div>

<a name="CWMIReg.GetValue"></a><a name="Topic4"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">GetValue</div>
 <div id="NDPrototype4" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function GetValue(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>GetValue returns the the value data, and also works to test the existence of a value.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The source array.</p></td></tr></table><div class="CHeading">Returns</div><p>On success function returns value data. The method returns a string value that is &quot;&quot; (empty) if value does not exist. Otherwise the return can be a standard error code from -1 to -5 (see <b>Error Codes</b>). If the function fails, the return value is a nonzero error code.</p></div>
</div>

<a name="CWMIReg.EnumKeys"></a><a name="Topic5"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">EnumKeys</div>
 <div id="NDPrototype5" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function EnumKeys(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_,</td></tr><tr><td class="PName first last">AKeys_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns list of sub keys in a key.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The key to be enumerated. Path may have &quot;\&quot; at end or not.</p></td></tr><tr><td class="CDLEntry">AKeys_</td><td class="CDLDefinition"><p>An array of key names.</p></td></tr></table><div class="CHeading">Returns</div><p>Function returns number of sub keys. Greater than 0 is the count of sub keys. Zero indicates no sub keys. Otherwise the return can be a standard error code from -1 to -5 (see <b>Error Codes</b>). If the function fails, the return value is a nonzero error code. AKeys contains sub key names.</p></div>
</div>

<a name="CWMIReg.EnumVals"></a><a name="Topic6"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">EnumVals</div>
 <div id="NDPrototype6" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function EnumVals(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_,</td></tr><tr><td class="PName first last">AValsOut_,</td></tr><tr><td class="PName first last">ATypesOut_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Return value names and type from a given key.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The source key.</p></td></tr><tr><td class="CDLEntry">AValsOut_</td><td class="CDLDefinition"><p>An array of value names. The value array will include the key's default value only if it is not blank (WMI only returns it if there is content). Also, the default value is not necessarily found in array(0). The array seems to return values in the order that they were created.</p></td></tr><tr><td class="CDLEntry">ATypesOut_</td><td class="CDLDefinition"><p>An array of data types.</p></td></tr></table><div class="CHeading">Returns</div><p>If return is &gt; 0 it represents the number of values in the key. A return of 0 indicates no values present and no data saved in the default value. The value count is the same as UBound(AValsOut) + 1. For example, if a given key has 3 values written, EnumVals will return 3 and the empty default value will be ignored. If you then assign a string to the default value in that key, EnumVals will return 4. -1 to -5 are the standard error codes (see <b>Error Codes</b>). If the function fails, the return value is a nonzero error code.</p></div>
</div>

<a name="CWMIReg.SetValue"></a><a name="Topic22"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">SetValue</div>
 <div id="NDPrototype22" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function SetValue(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_,</td></tr><tr><td class="PName first last">ValData_,</td></tr><tr><td class="PName first last">TypeIn_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Set value data.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>A key that contains the named value to be set. If key does not exist the key path will be created. You can specify an existing named value (update) or a new named value (create). Specify an empty string to set the data value for the default named value.</p></td></tr><tr><td class="CDLEntry">AValsOut_</td><td class="CDLDefinition"><p>ValData is value data. Data type of the ValData parameter varies by type. For String or XString values a string must be sent. DWord values must be numeric. Binary values must be sent as an array of byte values (numbers from 0 to 255). A MultiString value must be sent as an array of strings.</p></td></tr><tr><td class="CDLEntry">TypeIn_</td><td class="CDLDefinition"><p>(Optional) A data type. Use &quot;&quot; to SetValue function detect data type to use. If no type is sent then function will find type, but if value does not already exist when no type is sent it will default to string. Therefore, the type should always be sent when available.</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a int value that is 0 (zero) if successful.&nbsp; -1 to -5 are standard errors (see <b>Error Codes</b>). -6 = Incoming value not valid (data type of value data not coercible. Example: Assigning a string to ValData for a binary setting). -7 = Invalid data type value sent (for example, sending &quot;A&quot; as Type would be invalid). If the function fails, the return value is a nonzero error code.</p></div>
</div>

<a name="CWMIReg.CreateKey"></a><a name="Topic8"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CreateKey</div>
 <div id="NDPrototype8" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function CreateKey(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Create a key or value. Path can have &quot;\&quot; at end or not (since the function is unambiguous), but must not have &quot;\&quot; if path is an HKey like &quot;HKLM&quot;.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The key to be created. The CreateKey method creates all sub keys specified in the path that do not exist. For example, if MyKey and MySubKey do not exist in the following path, the CreateKey method creates both keys: HKEY_CURRENT_USER\SOFTWARE\MyKey\MySubKey.</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a int value that is 0 (zero) if successful. If the function fails, the return value is a nonzero error code.</p></div>
</div>

<a name="CWMIReg.Delete"></a><a name="Topic9"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Delete</div>
 <div id="NDPrototype9" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function Delete(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Delete a key (using DeleteKey) or value. Add &quot;\&quot; for keys.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The key or value to be deleted. The function will enumerate sub keys when a key is being deleted and will delete the sub keys in reverse order to allow deletion of the key specified in Path. For example, if MyKey and MySubKey does exist in the following path, the Delete method deletes both keys: HKEY_CURRENT_USER\SOFTWARE\MyKey\MySubKey.</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a int value that is 0 (zero) if successful. If the function fails, the return value is a standard error code (see <b>Error Codes</b>) or a nonzero error code.</p></div>
</div>

<a name="CWMIReg.TestPath"></a><a name="Topic10"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">TestPath</div>
 <div id="NDPrototype10" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function TestPath(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">PathIn_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Returns key level. The Delete function, since it is capable of deleting a key &quot;tree&quot;, has a built-in safety feature. It will return error code -1 (Invalid Path) if the PathIn_ parameter does not contain at least 3 backslashes. That prevents the accidental deletion of the main hive keys and their direct sub keys. In other words, HKCU cannot be deleted. Nor can HKCU\Software\.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">PathIn_</td><td class="CDLDefinition"><p>The key to be tested.</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a int value &gt; 0 (zero) if successful. If the function fails, the return value is a 0 (zero) error code.</p><ul><li><p>HKCU\Software\Classes\ = HKCR\ = -1 (Invalid path)</p></li><li><p>HKLM\Software\ = -1 (Invalid Path)</p></li><li><p>HKCU\ControlPanel\Desktop = 3</p></li><li><p>HKLM\Software\Microsoft\Windows NT\CurrentVersion = 5</p></li></ul><div class="CHeading">See Also</div><p><a href="../index.html#File:RegClass.vbs:CWMIReg.DeleteKey" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,16);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >DeleteKey</a></p></div>
</div>

<a name="CWMIReg.Class_Initialize"></a><a name="Topic11"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Class_Initialize</div>
 <div id="NDPrototype11" class="NDPrototype NoParameterForm">Private Sub Class_Initialize()</div>
 <div class="CBody"><ul><li><p>Set Locator (SWbemLocator) object and it's Constants.</p></li><li><p>Detect the bitness (32-bit or 64-bit) of the Windows OS.</p></li><li><p>Initialize logger objects with default values, i.e. disable debug.</p></li></ul></div>
</div>

<a name="CWMIReg.Class_Terminate"></a><a name="Topic12"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Class_Terminate</div>
 <div id="NDPrototype12" class="NDPrototype NoParameterForm">Private Sub Class_Terminate()</div>
 <div class="CBody"><ul><li><p>Set Locator (SWbemLocator) object to Nothing.</p></li></ul></div>
</div>

<a name="CWMIReg.GetHKey"></a><a name="Topic13"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">GetHKey</div>
 <div id="NDPrototype13" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function GetHKey(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">sKey1_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Assign Registry Root variable with its WMI hex equivalent.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">sKey1_</td><td class="CDLDefinition"><p>The key to be enumerated.</p></td></tr></table><div class="CHeading">Returns</div><p>Assign Registry Root variable with its WMI hex equivalent, or 0 if the operation failed.</p></div>
</div>

<a name="CWMIReg.ConvertType"></a><a name="Topic14"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ConvertType</div>
 <div id="NDPrototype14" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function ConvertType(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">TypeIn_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Assign Type variable with its WMI hex equivalent and vice-versa.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TypeIn_</td><td class="CDLDefinition"><p>The Type to be enumerated.</p></td></tr></table><div class="CHeading">Returns</div><p>Assign Type variable with its WMI hex equivalent and vice-versa. Returns &quot;&quot; for invalid data type.</p></div>
</div>

<a name="CWMIReg.EnumKeysAll"></a><a name="Topic15"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">EnumKeysAll</div>
 <div id="NDPrototype15" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Public Function EnumKeysAll(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_,</td></tr><tr><td class="PName first last">AKeys_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Return list of all sub keys in a key. EnumKeysAll has been made public, in case it might be useful, but it was really written for use in deleting keys.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The key to be enumerated.&nbsp; AKeys_ -</p></td></tr></table><div class="CHeading">Returns</div><p>Function returns number of sub keys. AKeys returns key paths.</p></div>
</div>

<a name="CWMIReg.DeleteKey"></a><a name="Topic16"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">DeleteKey</div>
 <div id="NDPrototype16" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Private Function DeleteKey(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">Path_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Deletes all sub keys in path by first calling EnumKeysAll. It then deletes parent key.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Path_</td><td class="CDLDefinition"><p>The key to be deleted.</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a int value that is 0 (zero) if successful. If the function fails, the return value is a nonzero error code.</p></div>
</div>

<a name="CWMIReg.DecimalNumbers"></a><a name="Topic17"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">DecimalNumbers</div>
 <div id="NDPrototype17" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">Private Function DecimalNumbers(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PName first last">strHex_</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Convert hex string to binary Array.</p><p>Author: Rems <a href="http://www.petri.co.il/forums/showthread.php?t=46158" target="_top">http://&#8203;www&#8203;.petri&#8203;.co&#8203;.il&#8203;/forums&#8203;/showthread&#8203;.php&#8203;?t=46158</a></p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">strHex_</td><td class="CDLDefinition"><p>The value to be converted. Example: &quot;hex:23,00,41,00,43,00,42,00,6c,00&quot;</p></td></tr></table><div class="CHeading">Returns</div><p>The method returns a decimal binary Array if successful.</p><div class="CHeading">See Also</div><p><a href="../index.html#File:RegClass.vbs:CWMIReg.SetValue" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,22);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SetValue</a></p></div>
</div>

</body></html>